<div class="rounded-lg border bg-white p-4 shadow-sm hover:shadow-md transition-shadow">
  <div class="flex flex-col md:flex-row md:items-start gap-4">
    <div class="flex-shrink-0">
      <% if ksession.code.present? %>
        <span class="inline-block rounded bg-slate-100 px-2 py-1 text-xs font-mono text-slate-700">
          <%= ksession.code %>
        </span>
      <% end %>
    </div>

    <div class="flex-1 min-w-0">
      <h3 class="font-semibold text-gray-900 text-lg"><%= ksession.title %></h3>

      <% if ksession.abstract.present? %>
        <p class="mt-2 text-sm text-gray-600 line-clamp-3"><%= ksession.abstract %></p>
      <% end %>

      <% if ksession.speakers.any? %>
        <div class="mt-3 space-y-2">
          <% ksession.speakers.each do |speaker| %>
            <%= link_to who_path(name: speaker.slug),
                class: "flex items-center gap-3 rounded-lg bg-slate-50 px-3 py-2 hover:bg-slate-100 transition-colors" do %>
              <% if speaker.image_url.present? %>
                <img src="<%= speaker.image_url %>" alt="" class="h-10 w-10 rounded-full object-cover flex-shrink-0">
              <% else %>
                <div class="h-10 w-10 rounded-full bg-slate-200 flex items-center justify-center flex-shrink-0">
                  <span class="text-slate-500 text-sm font-medium"><%= speaker.name.first.upcase %></span>
                </div>
              <% end %>
              <div class="min-w-0 flex-1">
                <div class="flex items-center gap-2 flex-wrap">
                  <span class="font-medium text-gray-900 text-sm"><%= speaker.name %></span>
                  <%# Show MVP badge if speaker has awards %>
                  <% if speaker.has_mvp_awards? %>
                    <span class="inline-flex items-center px-2 py-0.5 rounded-full text-[10px] font-medium bg-purple-100 text-purple-800">
                      <%= speaker.mvp_award_count %>x MVP
                    </span>
                  <% end %>
                  <%# Show Snapp cards as non-linked badges %>
                  <% if speaker.has_snapp_cards? %>
                    <% speaker.snapp_cards.each do |card| %>
                      <span class="inline-flex items-center px-2 py-0.5 rounded-full text-[10px] font-medium bg-green-100 text-green-800"
                            title="#{card.card_name} (#{card.edition})">
                        <%= card.card_name %>
                      </span>
                    <% end %>
                  <% end %>
                  <%# Show Startup Founder badges %>
                  <% if speaker.is_startup_founder? %>
                    <% speaker.startup_founders.each do |founder| %>
                      <span class="inline-flex items-center px-2 py-0.5 rounded-full text-[10px] font-medium bg-orange-100 text-orange-800"
                            title="Founder of #{founder.company_name}">
                        <svg class="h-3 w-3 mr-0.5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
                        </svg>
                        <%= founder.company_name %>
                      </span>
                    <% end %>
                  <% end %>
                </div>
                <% if speaker.title.present? || speaker.company_name.present? %>
                  <div class="text-xs text-gray-500 truncate">
                    <%= [speaker.title, speaker.company_name].compact.reject(&:blank?).join(" Â· ") %>
                  </div>
                <% end %>
              </div>
            <% end %>
          <% end %>
        </div>
      <% end %>

      <% times = ksession.times_array %>
      <% if times.any? %>
        <div class="mt-3 text-xs text-gray-500">
          <% times.first(2).each do |time| %>
            <span class="mr-3"><%= time["start"] %></span>
          <% end %>
        </div>
      <% end %>
    </div>

    <div class="flex-shrink-0 flex items-center gap-2">
      <% if ksession.recording_url.present? %>
        <%= link_to ksession.recording_url, target: "_blank", rel: "noopener",
            class: "inline-flex items-center gap-1 rounded bg-red-100 px-2 py-1 text-xs text-red-700 hover:bg-red-200" do %>
          <svg class="h-4 w-4" fill="currentColor" viewBox="0 0 24 24">
            <path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 4-8 4z"/>
          </svg>
          Watch
        <% end %>
      <% end %>

      <% if logged_in? %>
        <button type="button" class="rounded p-1 text-gray-400 hover:text-yellow-500 hover:bg-yellow-50" title="Save to list">
          <svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"/>
          </svg>
        </button>
      <% end %>
    </div>
  </div>
</div>
